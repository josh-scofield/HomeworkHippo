<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ93WQ5V');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeworkHippo - AI-Powered Science Homework Help</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%233B82F6%22><path d=%22M13 2L3 14h9l-1 8 10-12h-9l1-8z%22/></svg>">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PG6TK98RFE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PG6TK98RFE');
    </script>
    <script src="https://js.stripe.com/v3/"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #FFFFFF;
            --bg-secondary: #F9FAFB;
            --bg-tertiary: #F3F4F6;
            --text-primary: #111827;
            --text-secondary: #6B7280;
            --text-tertiary: #9CA3AF;
            --accent-orange: #3B82F6;
            --accent-orange-hover: #2563EB;
            --accent-purple: #8B5CF6;
            --border-primary: #E5E7EB;
            --border-secondary: #D1D5DB;
            --error: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header */
        header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-primary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-links {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 400;
            transition: color 0.2s ease;
        }

        .nav-links a:hover {
            color: var(--text-primary);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            font-size: 14px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
        }

        .btn-primary {
            background: var(--accent-orange);
            color: white;
            border: 1px solid var(--accent-orange);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--accent-orange-hover);
            border-color: var(--accent-orange-hover);
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 80px 0 120px;
            background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
        }

        .hero h1 {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: 24px;
            background: linear-gradient(135deg, var(--accent-orange) 0%, var(--accent-purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.1;
        }

        .hero p {
            font-size: 20px;
            color: var(--text-secondary);
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero .btn {
            font-size: 16px;
            padding: 14px 32px;
        }

        /* Main App Section */
        .app-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            box-shadow: var(--shadow-xl);
            border-radius: 16px;
            margin: -40px auto 60px;;
            padding: 32px;
            position: relative;
            max-width: 800px;
        }

        .question-input-section h2 {
            text-align: center;
            margin-bottom: 32px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 24px;
        }

        .input-container {
            margin-bottom: 20px;
        }

        #questionInput {
            width: 100%;
            padding: 16px;
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            font-size: 15px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.2s ease;
            font-family: inherit;
        }

        #questionInput:focus {
            outline: none;
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            background: var(--bg-primary);
        }

        #questionInput::placeholder {
            color: var(--text-tertiary);
        }

        .file-upload-container {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .file-upload-btn {
            background: var(--bg-tertiary);
            border: 1px dashed var(--border-secondary);
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            flex: 1;
            color: var(--text-secondary);
        }

        .file-upload-btn:hover {
            border-color: var(--accent-orange);
            background: rgba(249, 115, 22, 0.05);
        }

        .file-upload-btn input {
            display: none;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-orange), var(--accent-orange-hover));
            color: white;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-md);
        }

        .submit-btn:hover:not(:disabled) {
            background: var(--accent-orange-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Response Section */
        .response-section {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 24px;
            margin-top: 24px;
            display: none;
            border: 1px solid var(--border-primary);
        }

        .response-section.show {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 2px solid var(--border-primary);
            border-top: 2px solid var(--accent-orange);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .response-content {
            line-height: 1.7;
        }

        .response-content h3 {
            color: var(--accent-orange);
            margin: 24px 0 12px 0;
            font-weight: 600;
        }

        .response-content p {
            margin-bottom: 16px;
            color: var(--text-secondary);
        }

        .response-content strong {
            color: var(--text-primary);
        }

        /* Features Section */
        .features {
            padding: 80px 0;
            background: var(--bg-secondary);
        }

        .features h2 {
            text-align: center;
            margin-bottom: 64px;
            font-size: 40px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
        }

        .feature-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            padding: 32px;
            border-radius: 16px;
            text-align: center;
            transition: transform 0.2s ease, border-color 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-purple));
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
            
        .feature-card:hover::before {
            transform: translateX(0);
        }
       
        .feature-card:hover {
            transform: translateY(-4px);
            border-color: var(--border-secondary);
            box-shadow: var(--shadow-lg);
            border-color: transparent;
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 20px;
            display: block;
        }

        .feature-card h3 {
            margin-bottom: 16px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 18px;
        }

        .feature-card p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Pricing Section */
        .pricing {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-primary);
            border-bottom: 1px solid var(--border-primary);
            padding: 80px 0;
        }

        .pricing h2 {
            text-align: center;
            font-size: 40px;
            font-weight: 600;
            margin-bottom: 48px;
            color: var(--text-primary);
        }

        .pricing-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-primary);
    border-radius: 16px;
    padding: 40px;
    max-width: 400px;
    width: 400px;
    height: 575px;
    margin: 0 auto;
    text-align: center;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: visible;
    display: flex;
    flex-direction: column;
    animation: pulseGlow 4s ease-in-out infinite;
}

        @keyframes pulseGlow {
    0%, 100% {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 0 20px rgba(59, 130, 246, 0.3);
    }
    50% {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 0 30px rgba(59, 130, 246, 0.5);
    }
}

        .pricing-card:first-child::before {
            content: 'BEST VALUE';
            position: absolute;
            top: 20px;
            left: -30px;
            background: var(--accent-purple);
            color: white;
            padding: 4px 40px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.05em;
            transform: rotate(-45deg);
            border-radius: 2px;
        }

        .pricing-card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .price {
            font-size: 48px;
            font-weight: 700;
            margin: 16px 0;
            color: var(--text-primary);
        }

        .price span {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .price-features {
            list-style: none;
            margin: 32px 0;
            text-align: left;
        }

        .price-features li {
            padding: 8px 0;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .price-features li::before {
            content: "✓";
            color: var(--success);
            font-weight: 600;
        }

        .trial-note {
            margin-top: 20px;
            color: var(--text-tertiary);
            font-size: 14px;
        }

        /* Auth Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(8px);
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            padding: 32px;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 4px;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auth-form h2 {
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 24px;
        }

        .auth-form input {
            padding: 12px 16px;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            font-size: 15px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transition: border-color 0.2s ease;
        }

        .auth-form input:focus {
            outline: none;
            border-color: var(--accent-orange);
        }

        .auth-form input::placeholder {
            color: var(--text-tertiary);
        }

        .auth-form button {
            padding: 12px;
            background: var(--accent-orange);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .auth-form button:hover {
            background: var(--accent-orange-hover);
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .auth-switch a {
            color: var(--accent-orange);
            text-decoration: none;
        }

        .auth-switch a:hover {
            text-decoration: underline;
        }

        /* User Dashboard */
        .user-dashboard {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            margin: 40px auto;
            padding: 32px;
            max-width: 800px;
            display: none;
            box-shadow: var(--shadow-lg);
        }

        .user-dashboard.show {
            display: block;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-primary);
        }

        .dashboard-header h2 {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 24px;
        }

        .usage-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            padding: 24px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .logout-btn {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.2s ease;
        }

        .logout-btn:hover {
            opacity: 0.8;
        }

        /* Alert Messages */
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--error);
            color: var(--error);
        }

        /* Responsive */
        @media (max-width: 768px) {
    .nav-links {
        gap: 8px;
    }
    
    .nav-links a {
        display: none; /* Hide Features and Pricing links on mobile */
    }
    
    .nav-links .btn {
        padding: 8px 12px;
        font-size: 13px;
    }
    
    .hero h1 {
        font-size: 36px;
        padding: 0 20px;
    }
    
    .hero p {
        font-size: 16px;
        padding: 0 20px;
    }
    
    .app-section {
        margin: -20px 16px 40px;
        padding: 24px 16px;
    }

    .container {
        padding: 0 16px;
    }

    .hero {
        padding: 60px 0 80px;
    }

    .features h2, .pricing h2 {
        font-size: 28px;
    }

    .features-grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .feature-card {
        padding: 24px;
    }
    
    .pricing-card {
        padding: 32px 20px;
        margin: 0 16px;
    }
    
    .modal-content {
        width: 95%;
        padding: 24px;
        margin: 16px;
    }
    
    .modal-close {
        top: 12px;
        right: 12px;
        width: 28px;
        height: 28px;
    }
}
        @media (max-width: 768px) {
    /* Cancel flow buttons */
    #cancelStep1Modal .modal-content div[style*="display: flex"],
    #cancelStep2Modal .modal-content div[style*="display: flex"],
    #cancelStep3Modal .modal-content div[style*="display: flex"] {
        flex-direction: column !important;
        gap: 12px !important;
    }
    
    #cancelStep1Modal .btn,
    #cancelStep2Modal .btn,
    #cancelStep3Modal .btn {
        width: 100% !important;
    }
}

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Focus states for accessibility */
        .btn:focus,
        input:focus,
        textarea:focus {
            outline: 2px solid var(--accent-orange);
            outline-offset: 2px;
        }
            /* Account Settings Styles */
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-primary);
            margin-bottom: 2rem;
        }
        
        .settings-tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .settings-tab:hover {
            color: var(--text-primary);
        }
        
        .settings-tab.active {
            color: var(--accent-orange);
            border-bottom-color: var(--accent-orange);
        }
        
        .settings-content {
            padding: 1rem 0;
        }
        
        .settings-content h3 {
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            font-size: 18px;
        }
        
        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .settings-form label {
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .settings-form input {
            padding: 12px;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .billing-info p {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .usage-stats p {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .support-options p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }
    /* Toggle Switch */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 32px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--border-secondary);
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 24px;
    width: 24px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

input:checked + .slider {
    background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple));
}

input:checked + .slider:before {
    transform: translateX(28px);
}


/* Highlight savings when monthly is selected */
.billing-toggle-container {
    position: relative;
}
    
    
    
    
    
    </style>
    
    
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ93WQ5V"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <header>
        <nav class="container">
           <a href="#" class="logo">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--accent-orange)" style="display: inline-block; vertical-align: middle;">
        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
    </svg>
    HomeworkHippo
    <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--accent-orange)" style="display: inline-block; vertical-align: middle;">
        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
    </svg>
</a>
           <div class="nav-links">
    <a href="#features">Features</a>
    <a href="#pricing">Pricing</a>
    <button class="btn btn-primary" onclick="showModal('login')">Sign In</button>
</div>
        </nav>
    </header>

    <main class="container">
        <!-- Hero Section -->
        <section class="hero">
            <h1>AI-powered science homework help</h1>
            <p>Get step-by-step solutions and detailed explanations for your chemistry, physics, and biology questions using advanced AI.</p>
            <div style="text-align: center; margin: 25px 0 35px 0; animation: slideUp 0.8s ease-out;">
    <div style="display: inline-flex; align-items: center; gap: 12px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.05)); padding: 12px 24px; border-radius: 100px; border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); animation: pulse 4s ease-in-out infinite;">
        <span style="color: #fbbf24; font-size: 18px; filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.5)); animation: sparkle 2s ease-in-out infinite;">★★★★★</span>
        <span style="font-size: 14px; color: #64748b; font-weight: 500; letter-spacing: 0.3px;">
            Trusted by <strong style="background: linear-gradient(135deg, #3B82F6, #8B5CF6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700; font-size: 15px;">5,000+ students</strong> from <strong style="background: linear-gradient(135deg, #3B82F6, #8B5CF6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700; font-size: 15px;">100+ universities</strong>
        </span>
    </div>
</div>
<style>
        
@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    50% {
        transform: scale(1.02);
        box-shadow: 0 6px 30px rgba(59, 130, 246, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }
}

@keyframes sparkle {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.9;
        transform: scale(1.1);
    }
}

@media (max-width: 480px) {
    /* Mobile adjustments */
    div[style*="gap: 12px"] {
        padding: 10px 18px !important;
    }
}
</style>
            <a href="#" class="btn btn-primary" onclick="showModal('signup'); return false;">Try it now</a>
        </section>

        <!-- User Dashboard -->
        <section class="user-dashboard" id="userDashboard">
                   <div class="dashboard-header">
            <h2>Welcome back, <span id="userName">Student</span></h2>
            <div>
                <button class="btn btn-secondary" onclick="showAccountSettings()" style="margin-right: 10px; font-size: 14px;">Account Settings</button>
                <button class="logout-btn" onclick="logout()">Sign out</button>
            </div>
        </div>
            <div class="usage-stats">
        <div class="stat-card">
            <div class="stat-number" id="questionsAsked">0</div>
            <div class="stat-label">Questions this month</div>
        </div>
           
        <div class="stat-card">
            <div class="stat-number" id="questionsRemaining">3</div>
            <div class="stat-label">Questions remaining</div>
        </div>
                <div style="text-align: center; margin-top: 32px;">
        <button class="btn btn-primary" onclick="showTestGenerator()" style="padding: 14px 32px; font-size: 16px;">
            📝 Open Test Generator (Free!)
        </button>
        </div>
    </div>
</section>

        <!-- Main App Section -->
        <section class="app-section" id="app">
            <div class="question-input-section">
                <h2>Ask your science question</h2>
               <div class="input-container">
            <div class="typing-placeholder" id="typingPlaceholder"></div>
            <textarea 
                id="questionInput" 
                placeholder=""
                onfocus="hideTypingPlaceholder()"
                onblur="showTypingPlaceholder()"
                oninput="handleInputChange()"
            ></textarea>
        </div>
 <div class="file-upload-container">
    <label class="file-upload-btn-progress">
        <svg class="progress-ring" viewBox="0 0 100 100">
            <circle class="progress-circle" cx="50" cy="50" r="45"></circle>
        </svg>
        <svg class="camera-icon-center" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
            <circle cx="12" cy="13" r="3"/>
        </svg>
        <input type="file" id="imageUpload" accept="image/*" onchange="handleImageUpload(event)">
    </label>
    <div id="imagePreview" style="display: none;">
        <img id="previewImg" style="max-width: 200px; max-height: 200px; border-radius: 8px; border: 1px solid var(--border-primary);">
    </div>
</div>
                <button class="submit-btn" onclick="submitQuestion()" id="submitBtn">
                    Get solution
                </button>
            </div>

            <div class="response-section" id="responseSection">
                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p style="color: var(--text-secondary);">HomeworkHippo is analyzing your question...</p>
                </div>
                <div class="response-content" id="responseContent"></div>
            </div>
        </section>

        

        <!-- Test Generator Section -->
<section class="test-generator-section" id="testGenerator" style="display: none;>
    <div class="test-generator-header">
        <h2>📝 Free Test Generator</h2>
        <p>Create a custom practice test from your study materials</p>
    </div>
    
    <div id="testSetup" class="test-setup">
        <div class="test-input-area">
            <textarea id="testSourceInput" 
                placeholder="Paste or type sample problems here (e.g., 'Balance H2 + O2 → H2O' or 'Calculate the velocity of...')"></textarea>
        </div>
        
        <div class="file-upload-container">
            <label class="file-upload-btn">
                <span>📸 Upload image of problems</span>
                <input type="file" id="testImageUpload" accept="image/*" onchange="handleTestImageUpload(event)">
            </label>
            <div id="testImagePreview" style="display: none;">
                <img id="testPreviewImg" style="max-width: 200px; border-radius: 8px;">
            </div>
        </div>
        
        <div class="test-controls">
            <div class="question-count-selector">
                <label>Number of questions:</label>
                <select id="questionCount">
                    <option value="5">5 questions</option>
                    <option value="10" selected>10 questions</option>
                    <option value="15">15 questions</option>
                    <option value="20">20 questions (max)</option>
                </select>
            </div>
            
            <button class="btn btn-primary" onclick="generateTest()" id="generateTestBtn">
                Generate Test
            </button>
        </div>
    </div>
    
    <div id="testArea" style="display: none;">
        <div class="test-progress">
            <span>Question <span id="currentQuestion">1</span> of <span id="totalQuestions">10</span></span>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div class="question-display">
            <h3 id="questionText"></h3>
            <textarea id="answerInput" placeholder="Type your answer here..." class="answer-box"></textarea>
            <div class="test-navigation">
                <button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn">Previous</button>
                <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn">Next</button>
                <button class="btn btn-primary" onclick="submitTest()" id="submitTestBtn" style="display: none;">Grade Test!</button>
            </div>
        </div>
    </div>
    
    <!-- Results Modal -->
    <div class="modal" id="testResultsModal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="modal-close" onclick="hideTestResults()">&times;</button>
            <div class="test-results">
                <h2>Test Results</h2>
                <div class="grade-display">
                    <div class="grade-circle" id="gradeCircle">
                        <span class="grade-percent">85%</span>
                    </div>
                    <div class="grade-letter" id="gradeLetter">B</div>
                </div>
                <div class="results-breakdown">
                    <p><strong>Correct:</strong> <span id="correctCount">8</span> / <span id="totalCount">10</span></p>
                    <div id="incorrectAnswers" class="incorrect-answers"></div>
                </div>
                <button class="btn btn-primary" onclick="retakeTest()">Try Another Test</button>
            </div>
        </div>
    </div>
</section>

        <!-- Features Section -->
        <section class="features" id="features">
            <h2>Why choose HomeworkHippo?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <span class="feature-icon">🧪</span>
                    <h3>All sciences covered</h3>
                    <p>Get help with chemistry, physics, biology, and other science subjects with detailed explanations.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">📸</span>
                    <h3>Image recognition</h3>
                    <p>Upload photos of equations, diagrams, or problems for instant AI analysis and solutions.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">🎯</span>
                    <h3>Step-by-step solutions</h3>
                    <p>Learn the process, not just the answer. Understand how to solve similar problems independently.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">⚡</span>
                    <h3>Instant responses</h3>
                    <p>Powered by Claude AI for accurate, fast responses available 24/7 whenever you need help.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">📚</span>
                    <h3>Detailed explanations</h3>
                    <p>Get comprehensive breakdowns that help you understand underlying scientific concepts.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">🎓</span>
                    <h3>Learn effectively</h3>
                    <p>Improve your problem-solving skills with guided learning approaches and study tips.</p>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
       <section class="pricing" id="pricing">
    <h2>Choose Your Plan</h2>
    
 
           
           
           <!-- Billing Toggle -->
  <div style="text-align: center; margin-bottom: 48px;">
    <div style="display: inline-flex; align-items: center; gap: 16px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05)); padding: 12px 20px; border-radius: 100px; border: 1px solid var(--accent-orange);">
        <span style="font-weight: 600; color: var(--text-primary); font-size: 14px;">Monthly</span>
        <label class="toggle-switch">
            <input type="checkbox" id="billingToggle" onchange="toggleBilling()">
            <span class="slider"></span>
        </label>
        <span style="font-weight: 600; color: var(--text-primary); font-size: 14px;">
            Yearly <span style="background: linear-gradient(135deg, #10b981, #059669); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; font-size: 13px;">SAVE 34%</span>
        </span>
    </div>
    <div style="margin-top: 8px; font-size: 12px; color: var(--accent-orange); font-weight: 600;">
        💡 Tip: Switch to yearly and save over $40!
    </div>
</div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 32px; max-width: 900px; margin: 0 auto;">
        <!-- Basic Plan -->
        <div class="pricing-card">
            <h3>Basic</h3>
            <div class="price">
                <span class="monthly-price">$10<span>/month</span></span>
                <span class="yearly-price" style="display: none;">$79<span>/year</span></span>
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">Perfect for regular homework help</p>
            <ul class="price-features">
                <li><strong>100 questions</strong> per month</li>
                <li>Image upload support</li>
                <li>Step-by-step solutions</li>
                <li>All science subjects</li>
                <li>Email support</li>
            </ul>
            <button class="btn btn-primary" onclick="selectPlan('basic')" style="width: 100%; font-size: 16px;">
                Start Free Trial
            </button>
        </div>
        
        <!-- Unlimited Plan -->
        <div class="pricing-card" style="border: 2px solid var(--accent-orange); position: relative;">
    <div style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple)); color: white; padding: 4px 20px; border-radius: 100px; font-size: 12px; font-weight: 600; z-index: 100;">
        MOST POPULAR
    </div>
            <h3>Unlimited</h3>
            <div class="price">
                <span class="monthly-price">$19<span>/month</span></span>
                <span class="yearly-price" style="display: none;">$149<span>/year</span></span>
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">For serious students</p>
            <ul class="price-features">
                <li><strong>Unlimited questions</strong></li>
                <li>Everything in Basic, plus:</li>
                <li>Priority response time</li>
                <li>Advanced explanations</li>
                <li>Priority support</li>
            </ul>
            <button class="btn btn-primary" onclick="selectPlan('unlimited')" style="width: 100%; font-size: 16px;">
                Start Free Trial
            </button>
        </div>
    </div>
    
    <p style="text-align: center; margin-top: 32px; color: var(--text-tertiary); font-size: 14px;">
        ✓ 7-day free trial • ✓ Cancel anytime • ✓ No hidden fees
    </p>
</section>
    </main>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="modal-close" onclick="hideModal()">&times;</button>
            <div id="loginForm">
                <form class="auth-form" onsubmit="handleLogin(event)">
                    <h2>Sign in to HomeworkHippo</h2>
                    <input type="email" placeholder="Email" required id="loginEmail">
                    <input type="password" placeholder="Password" required id="loginPassword">
                    <button type="submit">Sign in</button>
                </form>
                <p class="auth-switch">
            Don't have an account? <a href="#" onclick="switchToSignup()">Create account</a>
        </p>
            </div>
            <div id="signupForm" style="display: none;">
    <form class="auth-form" onsubmit="handleSignup(event)">
        <h2>Create your account</h2>
        <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">
            Sign up to start your 7-day free trial
        </p>
        
        <input type="email" placeholder="Email address" required id="signupEmail">
        
        <div style="position: relative; margin-top: 16px;">
    <input type="tel" 
           placeholder="Phone number (for account recovery)" 
           required 
           id="signupPhone" 
           oninput="formatPhoneNumber(this); updateSubmitButton();"
           maxlength="14"
           style="width: 100%; padding: 12px 16px; border: 1px solid var(--border-primary); border-radius: 8px; font-size: 15px; background: var(--bg-tertiary); color: var(--text-primary);">
    <div style="font-size: 11px; color: var(--text-tertiary); margin-top: 4px;">
        Format: (555) 555-5555 • Used only for account recovery
    </div>
</div>
        
        <div style="position: relative;">
            <input type="password" placeholder="Create password" required id="signupPassword" 
                   oninput="checkPasswordStrength()" minlength="6">
            <div id="passwordStrength" style="margin-top: 8px; display: none;">
                <div style="display: flex; gap: 4px; margin-bottom: 6px;">
                    <div class="strength-bar" id="bar1"></div>
                    <div class="strength-bar" id="bar2"></div>
                    <div class="strength-bar" id="bar3"></div>
                    <div class="strength-bar" id="bar4"></div>
                </div>
                <div id="strengthText" style="font-size: 12px; color: var(--text-tertiary);"></div>
                <div id="passwordRequirements" style="font-size: 11px; color: var(--text-tertiary); margin-top: 4px;">
                    <div id="req-length">• At least 6 characters</div>
                    <div id="req-upper">• One uppercase letter</div>
                    <div id="req-special">• One special character (!@#$%^&*)</div>
                </div>
            </div>
        </div>
        
        <div style="position: relative;">
            <input type="password" placeholder="Confirm password" required id="confirmPassword" 
                   oninput="checkPasswordMatch()">
            <div id="passwordMatch" style="margin-top: 6px; font-size: 12px; display: none;"></div>
        </div>
        
        <button type="submit" id="signupSubmitBtn" disabled>Start Solving Now!</button>
        
        <div style="text-align: center; margin-top: 16px; padding: 12px; background: rgba(59, 130, 246, 0.05); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.1);">
            <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 6px;">
                <svg width="16" height="16" fill="var(--accent-orange)" viewBox="0 0 24 24">
                    <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                    <path fill="white" d="M10 17l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/>
                </svg>
                <span style="font-size: 12px; font-weight: 600; color: var(--accent-orange);">Secure & Private</span>
            </div>
            <div style="font-size: 11px; color: var(--text-secondary);">
                Your email is never shared. Cancel anytime.
            </div>
        </div>
    </form>
    <p class="auth-switch">
        Already have an account? <a href="#" onclick="switchToLogin()">Sign in</a>
    </p>
</div>

<style>
/* Progress Ring Upload Button - Properly Centered */
.file-upload-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
}

.file-upload-btn-progress {
    background: var(--bg-tertiary);
    border: none;
    padding: 0;
    border-radius: 50%;
    cursor: pointer;
    width: 88px;
    height: 88px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.3s ease;
}

.file-upload-btn-progress input {
    display: none;
}

.progress-ring {
    position: absolute;
    top: 0;
    left: 0;
    width: 88px;
    height: 88px;
}

.progress-circle {
    fill: none;
    stroke: var(--accent-orange);
    stroke-width: 3;
    stroke-dasharray: 282.74;
    stroke-dashoffset: 282.74;
    animation: progress 3s ease-in-out infinite;
    transform-origin: center;
    transform: rotate(-90deg);
}

@keyframes progress {
    0%, 100% { stroke-dashoffset: 282.74; }
    50% { stroke-dashoffset: 0; }
}

.camera-icon-center {
    color: var(--accent-orange);
    z-index: 2;
    position: relative;
}

.file-upload-btn-progress:hover {
    transform: scale(1.05);
    background: rgba(59, 130, 246, 0.05);
}

.file-upload-btn-progress:hover .progress-circle {
    stroke: var(--accent-purple);
    animation-duration: 1.5s;
}

    /* Typing animation and shimmer effect */
#questionInput::placeholder {
    color: transparent;
}

.typing-placeholder {
    position: absolute;
    top: 16px;
    left: 16px;
    color: var(--text-tertiary);
    font-size: 15px;
    font-family: inherit;
    pointer-events: none;
    z-index: 1;
    background: linear-gradient(90deg, 
        var(--text-tertiary) 0%, 
        var(--accent-orange) 50%, 
        var(--text-tertiary) 100%);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: shimmer 3s ease-in-out infinite;
}

.typing-placeholder::after {
    content: '|';
    color: var(--accent-orange);
    animation: blink 1s infinite;
    -webkit-text-fill-color: var(--accent-orange);
}

@keyframes shimmer {
    0%, 100% {
        background-position: -200% 0;
    }
    50% {
        background-position: 200% 0;
    }
}

@keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
}

.input-container {
    position: relative;
}
/* Enhanced question input section - external glow only */
.app-section {
    animation: pulseGlow 4s ease-in-out infinite;
}

@keyframes pulseGlow {
    0%, 100% {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 0 20px rgba(59, 130, 246, 0.3);
    }
    50% {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 0 30px rgba(59, 130, 246, 0.5);
    }
}
.strength-bar {
    height: 4px;
    flex: 1;
    background: var(--border-primary);
    border-radius: 2px;
    transition: background-color 0.3s ease;
}

.strength-bar.weak {
    background: #ef4444;
}

.strength-bar.fair {
    background: #f59e0b;
}

.strength-bar.good {
    background: #10b981;
}

.strength-bar.strong {
    background: #059669;
}

.requirement-met {
    color: var(--accent-orange) !important;
}

.requirement-met::before {
    content: "✓ " !important;
}

.password-match {
    color: var(--accent-orange);
}

.password-no-match {
    color: #ef4444;
}

.auth-form input:invalid {
    border-color: var(--border-primary);
}

.auth-form input:valid {
    border-color: var(--accent-orange);
}

.auth-form button:disabled {
    background: var(--text-tertiary);
    cursor: not-allowed;
    opacity: 0.6;
}

/* Test Generator Styles */
.test-generator-section {
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    box-shadow: var(--shadow-xl);
    border-radius: 16px;
    margin: 40px auto;
    padding: 32px;
    max-width: 800px;
}

.test-progress {
    margin-bottom: 24px;
    text-align: center;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: var(--bg-tertiary);
    border-radius: 4px;
    margin-top: 12px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple));
    transition: width 0.3s ease;
    width: 10%;
}

.question-display h3 {
    color: var(--text-primary);
    margin-bottom: 20px;
    font-size: 18px;
    line-height: 1.5;
}

.answer-box {
    width: 100%;
    min-height: 150px;
    padding: 16px;
    border: 1px solid var(--border-primary);
    border-radius: 12px;
    font-size: 15px;
    background: var(--bg-tertiary);
    margin-bottom: 20px;
    resize: vertical;
}

.test-navigation {
    display: flex;
    justify-content: space-between;
    gap: 12px;
}

.grade-display {
    text-align: center;
    margin: 32px 0;
}

.grade-circle {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 48px;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple));
    color: white;
    box-shadow: var(--shadow-lg);
}

.grade-letter {
    font-size: 72px;
    font-weight: 700;
    margin-top: 20px;
    background: linear-gradient(135deg, var(--accent-orange), var(--accent-purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.incorrect-answers {
    margin-top: 24px;
    text-align: left;
}

.incorrect-item {
    background: var(--bg-tertiary);
    padding: 16px;
    border-radius: 8px;
    margin-bottom: 12px;
    border-left: 4px solid var(--error);
}

    
</style>

<script>
// Typing animation variables
let typingInterval;
let currentTypingIndex = 0;
let currentCharIndex = 0;
let isDeleting = false;
let isTypingActive = true;

const questions = [
    "What phase of mitosis is characterized by the alignment of chromosomes on the cell's equator?",
    "Balance the following chemical equation: H₂ + O₂ → H₂O?",
    "An airplane accelerates down a runway at 3.20 m/s2 for 32.8 s until it finally lifts off the ground. Determine the distance traveled before takeoff.", 
    "Use Rolles theorem to derive the mean value theorem.",
    "Explain what changes and what stays the same when 1.00 L of a solution of NaCl is diluted to 1.80 L.",
];

function startTypingAnimation() {
    if (!isTypingActive) return;
    
    const placeholder = document.getElementById('typingPlaceholder');
    const currentQuestion = questions[currentTypingIndex];
    
    if (!isDeleting && currentCharIndex <= currentQuestion.length) {
        // Typing
        placeholder.textContent = currentQuestion.substring(0, currentCharIndex);
        currentCharIndex++;
        setTimeout(startTypingAnimation, 100);
    } else if (isDeleting && currentCharIndex >= 0) {
        // Deleting
        placeholder.textContent = currentQuestion.substring(0, currentCharIndex);
        currentCharIndex--;
        setTimeout(startTypingAnimation, 50);
    } else if (!isDeleting && currentCharIndex > currentQuestion.length) {
        // Pause before deleting
        setTimeout(() => {
            isDeleting = true;
            startTypingAnimation();
        }, 2000);
    } else if (isDeleting && currentCharIndex < 0) {
        // Move to next question
        isDeleting = false;
        currentQuestionIndex = (currentQuestionIndex + 1) % questions.length;
        setTimeout(startTypingAnimation, 500);
    }
}

function hideTypingPlaceholder() {
    isTypingActive = false;
    document.getElementById('typingPlaceholder').style.display = 'none';
}

function showTypingPlaceholder() {
    const input = document.getElementById('questionInput');
    if (input.value.trim() === '') {
        isTypingActive = true;
        document.getElementById('typingPlaceholder').style.display = 'block';
        startTypingAnimation();
    }
}

function handleInputChange() {
    const input = document.getElementById('questionInput');
    if (input.value.trim() !== '') {
        hideTypingPlaceholder();
    }
}

// Start animation when page loads
document.addEventListener('DOMContentLoaded', function() {
    // ... your existing DOMContentLoaded code ...
    
    // Start typing animation
    setTimeout(startTypingAnimation, 1000);
});
    
function checkPasswordStrength() {
    const password = document.getElementById('signupPassword').value;
    const strengthDiv = document.getElementById('passwordStrength');
    const strengthText = document.getElementById('strengthText');
    const bars = document.querySelectorAll('.strength-bar');
    
    // Show strength indicator when user starts typing
    if (password.length > 0) {
        strengthDiv.style.display = 'block';
    } else {
        strengthDiv.style.display = 'none';
        updateSubmitButton();
        return;
    }
    
    // Reset bars
    bars.forEach(bar => {
        bar.className = 'strength-bar';
    });
    
    let score = 0;
    let feedback = '';
    
    // Check requirements
    const hasLength = password.length >= 6;
    const hasUpper = /[A-Z]/.test(password);
    const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
    
    // Update requirement indicators
    document.getElementById('req-length').className = hasLength ? 'requirement-met' : '';
    document.getElementById('req-upper').className = hasUpper ? 'requirement-met' : '';
    document.getElementById('req-special').className = hasSpecial ? 'requirement-met' : '';
    
    // Calculate score
    if (hasLength) score++;
    if (hasUpper) score++;
    if (hasSpecial) score++;
    if (password.length >= 8) score++;
    
    // Update strength bars and text
    if (score === 1) {
        bars[0].classList.add('weak');
        feedback = 'Weak';
        strengthText.style.color = '#ef4444';
    } else if (score === 2) {
        bars[0].classList.add('fair');
        bars[1].classList.add('fair');
        feedback = 'Fair';
        strengthText.style.color = '#f59e0b';
    } else if (score === 3) {
        bars[0].classList.add('good');
        bars[1].classList.add('good');
        bars[2].classList.add('good');
        feedback = 'Good';
        strengthText.style.color = '#10b981';
    } else if (score === 4) {
        bars.forEach(bar => bar.classList.add('strong'));
        feedback = 'Strong';
        strengthText.style.color = '#059669';
    }
    
    strengthText.textContent = feedback;
    updateSubmitButton();
}

function checkPasswordMatch() {
    const password = document.getElementById('signupPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const matchDiv = document.getElementById('passwordMatch');
    
    if (confirmPassword.length > 0) {
        matchDiv.style.display = 'block';
        if (password === confirmPassword) {
            matchDiv.textContent = '✓ Passwords match';
            matchDiv.className = 'password-match';
        } else {
            matchDiv.textContent = '✗ Passwords do not match';
            matchDiv.className = 'password-no-match';
        }
    } else {
        matchDiv.style.display = 'none';
    }
    
    updateSubmitButton();
}

function updateSubmitButton() {
    const password = document.getElementById('signupPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const submitBtn = document.getElementById('signupSubmitBtn');
    
    // Check all requirements
    const hasLength = password.length >= 6;
    const hasUpper = /[A-Z]/.test(password);
    const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
    const passwordsMatch = password === confirmPassword && confirmPassword.length > 0;
    const hasEmail = document.getElementById('signupEmail').value.length > 0;
    
    const allValid = hasLength && hasUpper && hasSpecial && passwordsMatch && hasEmail;
    
    submitBtn.disabled = !allValid;
}


</script>
        </div>
    </div>
    
    <!-- Subscription Modal -->
    <div class="modal" id="subscriptionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="hideSubscriptionModal()">&times;</button>
            <div style="text-align: center;">
                <h2>Upgrade to Premium</h2>
                <div style="margin: 2rem 0;">
                    <div class="price">$10<span>/month</span></div>
                    <ul class="price-features" style="text-align: left; margin: 1.5rem 0;">
                        <li>Unlimited questions</li>
                        <li>Image upload support</li>
                        <li>Step-by-step solutions</li>
                        <li>All science subjects</li>
                        <li>24/7 availability</li>
                        <li>Cancel anytime</li>
                    </ul>
                    <button class="btn btn-primary" onclick="startSubscription()" style="width: 100%; font-size: 16px; padding: 16px;">
                        Start Subscription
                    </button>
                    <p style="margin-top: 1rem; color: var(--text-tertiary); font-size: 14px;">
                        7-day free trial • Cancel anytime
                    </p>
                </div>
            </div>
        </div>
    </div>

        <!-- Account Settings Modal -->
    <div class="modal" id="accountSettingsModal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="modal-close" onclick="hideAccountSettings()">&times;</button>
            <div>
                <h2>Account Settings</h2>
                <div class="settings-tabs">
                    <button class="settings-tab active" onclick="showSettingsTab('profile')">Profile</button>
                    <button class="settings-tab" onclick="showSettingsTab('billing')">Billing</button>
                    <button class="settings-tab" onclick="showSettingsTab('usage')">Usage</button>
                    <button class="settings-tab" onclick="showSettingsTab('support')">Support</button>
                </div>
            
                <!-- Profile Tab -->
                <div class="settings-content" id="profileTab">
                    <h3>Profile Information</h3>
                    <div class="settings-form">
                        <label>Name:</label>
                        <input type="text" id="profileName" readonly>
                        <label>Email:</label>
                        <input type="email" id="profileEmail" readonly>
                        <label>Member since:</label>
                        <input type="text" value="August 2024" readonly>
                    </div>
                </div>
            
                <!-- Billing Tab -->
                <div class="settings-content" id="billingTab" style="display: none;">
                    <h3>Billing & Subscription</h3>
                    <div class="billing-info">
                        <p><strong>Current Plan:</strong> Student Plan ($10/month)</p>
                        <p><strong>Status:</strong> <span style="color: var(--success);">Active</span></p>
                        <p><strong>Next billing:</strong> September 5, 2024</p>
                        <button class="btn btn-secondary" onclick="updatePaymentMethod()">Update Payment Method</button>
                    </div>
                    <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-primary);">
                        <a href="#" onclick="showCancelFlow()" style="color: var(--text-tertiary); font-size: 14px;">Cancel subscription</a>
                    </div>
                </div>
            
                <!-- Usage Tab -->
                <div class="settings-content" id="usageTab" style="display: none;">
                    <h3>Usage Statistics</h3>
                    <div class="usage-stats">
                        <p><strong>Questions this month:</strong> <span id="settingsQuestionsUsed">0</span></p>
                        <p><strong>Total questions:</strong> <span id="settingsTotalQuestions">0</span></p>
                        <p><strong>Favorite subjects:</strong> Chemistry, Physics</p>
                        <p><strong>Average response time:</strong> 3.2 seconds</p>
                       </div>
                </div>
            
                <!-- Support Tab -->
                <div class="settings-content" id="supportTab" style="display: none;">
                    <h3>Help & Support</h3>
                    <div class="support-options">
                        <p><strong>Need help?</strong></p>
                        <button class="btn btn-secondary" onclick="contactSupport()">Contact Support</button>
                        <p style="margin-top: 1rem;"><strong>Email:</strong> support@homeworkhippo.com</p>
                        <p><strong>Response time:</strong> Within 24 hours</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancel Flow Step 1 - Are you sure? -->
    <div class="modal" id="cancelStep1Modal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <button class="modal-close" onclick="hideCancelStep1()">&times;</button>
            <div style="padding: 1rem;">
                <h2 style="color: var(--error); margin-bottom: 1rem;">Wait! Before you go...</h2>
                <p style="margin-bottom: 2rem; color: var(--text-secondary);">
                    Are you sure you want to cancel your HomeworkHippo subscription? You'll lose access to unlimited science help and step-by-step solutions.
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-primary" onclick="hideCancelStep1()">Keep My Subscription</button>
                    <button class="btn btn-secondary" onclick="showCancelStep2()">Continue Canceling</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Cancel Flow Step 2 - Alternatives -->
    <div class="modal" id="cancelStep2Modal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <button class="modal-close" onclick="hideCancelStep2()">&times;</button>
            <div style="padding: 1rem;">
                <h2 style="margin-bottom: 1rem;">We'd hate to lose you!</h2>
                <p style="margin-bottom: 2rem; color: var(--text-secondary);">
                    Before you cancel, would any of these options help instead?
                </p>
                <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 2rem;">
                    <button class="btn btn-primary" onclick="pauseSubscription()" style="width: 100%;">
                        Pause for 30 days (keep your account)
                    </button>
                    <button class="btn btn-secondary" onclick="contactSupport()" style="width: 100%;">
                        Get help from support team
                    </button>
                    <button class="btn btn-secondary" onclick="hideCancelStep2(); showAccountSettings();" style="width: 100%;">
                        Return to account settings
                    </button>
                </div>
                <a href="#" onclick="showCancelStep3()" style="color: var(--text-tertiary); font-size: 14px; text-decoration: underline;">
                    No thanks, I still want to cancel
                </a>
            </div>
        </div>
    </div>
    
    <!-- Cancel Flow Step 3 - Final confirmation -->
    <div class="modal" id="cancelStep3Modal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <button class="modal-close" onclick="hideCancelStep3()">&times;</button>
            <div style="padding: 1rem;">
                <h2 style="color: var(--error); margin-bottom: 1rem;">Final Step</h2>
                <p style="margin-bottom: 1rem; color: var(--text-secondary);">
                    Help us improve by telling us why you're leaving:
                </p>
                <select style="width: 100%; padding: 12px; margin-bottom: 2rem; border: 1px solid var(--border-primary); border-radius: 8px; background: var(--bg-tertiary); color: var(--text-primary);">
                    <option>Too expensive</option>
                    <option>Not using it enough</option>
                    <option>Found a better alternative</option>
                    <option>Technical issues</option>
                    <option>Don't need it anymore</option>
                    <option>Other</option>
                </select>
                <p style="margin-bottom: 2rem; color: var(--text-secondary); font-size: 14px;">
                    Your subscription will end on <strong>September 5, 2024</strong>. You'll keep access until then.
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-primary" onclick="hideCancelStep3()">Keep Subscription</button>
                    <button class="btn btn-secondary" onclick="confirmCancellation()">Cancel Subscription</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // uration with your API keys
       const CONFIG = {
    STRIPE_PUBLISHABLE_KEY: 'pk_live_51RrjC3L2nArkOzJtpcGX74Pbll4bQJ9bRzseceogRrA3MBe0OAnmNxYGCeJn4sxt6rgIBiknJuNkXS3CU5tHQTFf00HtLxSp3o',
    PRICES: {
        BASIC_MONTHLY: 'price_1RzmorL2nArkOzJtS1wOqDWt',
        BASIC_YEARLY: 'price_1Rzms9L2nArkOzJtz9G8avYa',
        UNLIMITED_MONTHLY: 'price_1RzmuLL2nArkOzJtQTyj3Syv',
        UNLIMITED_YEARLY: 'price_1RzmvcL2nArkOzJtWOUv9Sqs'
    }
};
       
        // Phone number formatting
function formatPhoneNumber(input) {
    let value = input.value.replace(/\D/g, '');
    if (value.length > 0) {
        if (value.length <= 3) {
            value = `(${value}`;
        } else if (value.length <= 6) {
            value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
        } else {
            value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
        }
    }
    input.value = value;
}

// Pricing variables
let currentBillingPeriod = 'monthly';

function toggleBilling() {
    const isYearly = document.getElementById('billingToggle').checked;
    if (isYearly) {
        showYearlyPricing();
    } else {
        showMonthlyPricing();
    }
}

function showMonthlyPricing() {
    currentBillingPeriod = 'monthly';
    document.getElementById('billingToggle').checked = false;
    document.querySelectorAll('.monthly-price').forEach(el => el.style.display = 'block');
    document.querySelectorAll('.yearly-price').forEach(el => el.style.display = 'none');
}

function showYearlyPricing() {
    currentBillingPeriod = 'yearly';
    document.getElementById('billingToggle').checked = true;
    document.querySelectorAll('.yearly-price').forEach(el => el.style.display = 'block');
    document.querySelectorAll('.monthly-price').forEach(el => el.style.display = 'none');
}
function selectPlan(planType) {
    if (!currentUser) {
        localStorage.setItem('selected_plan', planType);
        localStorage.setItem('billing_period', currentBillingPeriod);
        showModal('signup');
        return;
    }
    
    startCheckout(planType, currentBillingPeriod);
}

async function startCheckout(planType, billingPeriod) {
    const priceKey = `${planType.toUpperCase()}_${billingPeriod.toUpperCase()}`;
    const priceId = CONFIG.PRICES[priceKey];
    
    try {
        const { error } = await stripe.redirectToCheckout({
            lineItems: [{
                price: priceId,
                quantity: 1,
            }],
            mode: 'subscription',
            successUrl: window.location.origin + '/success.html?plan=' + planType,
            cancelUrl: window.location.origin + '/#pricing',
            customerEmail: currentUser.email,
        });

        if (error) {
            console.error('Stripe error:', error);
            showAlert('Error starting subscription. Please try again.', 'error');
        }
    } catch (error) {
        console.error('Checkout error:', error);
        showAlert('Error starting subscription. Please try again.', 'error');
    }
}

        
        // Initialize Stripe
        const stripe = Stripe(CONFIG.STRIPE_PUBLISHABLE_KEY);

        // Global state
        let currentUser = null;
        let questionCount = 0;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            const savedUser = localStorage.getItem('homeworkhippo_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showUserDashboard();
            }

            questionCount = parseInt(localStorage.getItem('question_count') || '0');
            updateQuestionCount();
        });

        // Test Generator Variables
let testQuestions = [];
let currentQuestionIndex = 0;
let userAnswers = [];
let testGenerated = false;

// Handle test image upload
function handleTestImageUpload(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('testImagePreview').style.display = 'block';
            document.getElementById('testPreviewImg').src = e.target.result;
        };
        reader.readAsDataURL(file);
    }
}

// Generate test using Claude API
async function generateTest() {
    const sourceText = document.getElementById('testSourceInput').value;
    const imageFile = document.getElementById('testImageUpload').files[0];
    const questionCount = document.getElementById('questionCount').value;
    
    if (!sourceText && !imageFile) {
        showAlert('Please provide sample problems or upload an image', 'error');
        return;
    }
    
    const btn = document.getElementById('generateTestBtn');
    btn.disabled = true;
    btn.textContent = 'Generating...';
    
    try {
        // Prepare request
        const requestBody = {
            action: 'generateTest',
            sourceContent: sourceText,
            questionCount: parseInt(questionCount),
            subject: 'science' // You can make this dynamic
        };
        
        if (imageFile) {
            const base64 = await fileToBase64(imageFile);
            requestBody.imageData = base64.split(',')[1];
        }
        
        // Call your API
        const response = await fetch('/api/test-generator.js', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(requestBody)
        });
        
        const data = await response.json();
        
        if (data.success) {
            testQuestions = data.questions;
            userAnswers = new Array(testQuestions.length).fill('');
            showTest();
        }
    } catch (error) {
        console.error('Error generating test:', error);
        showAlert('Failed to generate test. Please try again.', 'error');
    } finally {
        btn.disabled = false;
        btn.textContent = 'Generate Test';
    }
}

// Display the test
function showTest() {
    document.getElementById('testSetup').style.display = 'none';
    document.getElementById('testArea').style.display = 'block';
    document.getElementById('totalQuestions').textContent = testQuestions.length;
    currentQuestionIndex = 0;
    displayQuestion();
}

// Display current question
function displayQuestion() {
    const question = testQuestions[currentQuestionIndex];
    document.getElementById('questionText').textContent = `${currentQuestionIndex + 1}. ${question.question}`;
    document.getElementById('answerInput').value = userAnswers[currentQuestionIndex] || '';
    document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
    
    // Update progress bar
    const progress = ((currentQuestionIndex + 1) / testQuestions.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
    
    // Update navigation buttons
    document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
    document.getElementById('nextBtn').style.display = currentQuestionIndex === testQuestions.length - 1 ? 'none' : 'block';
    document.getElementById('submitTestBtn').style.display = currentQuestionIndex === testQuestions.length - 1 ? 'block' : 'none';
}

// Navigation functions
function nextQuestion() {
    userAnswers[currentQuestionIndex] = document.getElementById('answerInput').value;
    if (currentQuestionIndex < testQuestions.length - 1) {
        currentQuestionIndex++;
        displayQuestion();
    }
}

function previousQuestion() {
    userAnswers[currentQuestionIndex] = document.getElementById('answerInput').value;
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        displayQuestion();
    }
}

// Submit and grade test
async function submitTest() {
    userAnswers[currentQuestionIndex] = document.getElementById('answerInput').value;
    
    // Check if all questions answered
    const unanswered = userAnswers.filter(a => !a.trim()).length;
    if (unanswered > 0) {
        if (!confirm(`You have ${unanswered} unanswered questions. Submit anyway?`)) {
            return;
        }
    }
    
    // Grade the test
    const results = await gradeTest();
    showTestResults(results);
}

// Grade test using Claude API
async function gradeTest() {
    try {
        const response = await fetch('/api/test-generator.js', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                action: 'gradeTest',
                questions: testQuestions,
                answers: userAnswers
            })
        });
        
        const data = await response.json();
        return data.results;
    } catch (error) {
        console.error('Error grading test:', error);
        return null;
    }
}

// Show test results
function showTestResults(results) {
    const correct = results.filter(r => r.correct).length;
    const total = results.length;
    const percentage = Math.round((correct / total) * 100);
    
    // Calculate letter grade
    let letterGrade = 'F';
    if (percentage >= 90) letterGrade = 'A';
    else if (percentage >= 80) letterGrade = 'B';
    else if (percentage >= 70) letterGrade = 'C';
    else if (percentage >= 60) letterGrade = 'D';
    
    // Update modal
    document.querySelector('.grade-percent').textContent = percentage + '%';
    document.getElementById('gradeLetter').textContent = letterGrade;
    document.getElementById('correctCount').textContent = correct;
    document.getElementById('totalCount').textContent = total;
    
    // Show incorrect answers
    const incorrectDiv = document.getElementById('incorrectAnswers');
    incorrectDiv.innerHTML = '';
    
    results.forEach((result, index) => {
        if (!result.correct) {
            const item = document.createElement('div');
            item.className = 'incorrect-item';
            item.innerHTML = `
                <strong>Question ${index + 1}:</strong> ${testQuestions[index].question}<br>
                <span style="color: var(--error);">Your answer:</span> ${userAnswers[index] || 'No answer'}<br>
                <span style="color: var(--success);">Correct answer:</span> ${result.correctAnswer}<br>
                <span style="color: var(--text-secondary);">Explanation:</span> ${result.explanation}
            `;
            incorrectDiv.appendChild(item);
        }
    });
    
    document.getElementById('testResultsModal').classList.add('show');
}

// Hide test results
function hideTestResults() {
    document.getElementById('testResultsModal').classList.remove('show');
}

// Retake test
function retakeTest() {
    hideTestResults();
    document.getElementById('testSetup').style.display = 'block';
    document.getElementById('testArea').style.display = 'none';
    document.getElementById('testSourceInput').value = '';
    document.getElementById('testImagePreview').style.display = 'none';
    testQuestions = [];
    userAnswers = [];
}
        
        
        // Image upload handling
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                if (file.size > 10 * 1024 * 1024) {
                    alert('File size must be less than 10MB');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    const img = document.getElementById('previewImg');
                    img.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        // Submit question function
        async function submitQuestion() {
            const question = document.getElementById('questionInput').value.trim();
            const imageFile = document.getElementById('imageUpload').files[0];

            if (!question && !imageFile) {
                showAlert('Please enter a question or upload an image.', 'error');
                return;
            }

        if (!currentUser) {
            showAlert('Please sign in to ask questions.', 'error');
            showModal('login');
            return;
        }
        
        // Refresh user data to check latest subscription status
        try {
            const userResponse = await fetch(`/api/users.js?email=${currentUser.email}`);
            const userData = await userResponse.json();
            if (userData.success) {
                currentUser = userData.user;
                localStorage.setItem('homeworkhippo_user', JSON.stringify(currentUser));
            }
        } catch (error) {
            console.error('Error refreshing user data:', error);
        }
        
      function showTestGenerator() {
    // Hide other sections
    document.getElementById('userDashboard').style.display = 'none';
    document.getElementById('app').style.display = 'none';
    
    // Show test generator
    document.getElementById('testGenerator').style.display = 'block';
    
    // Scroll to top
    window.scrollTo(0, 0);
}

function hideTestGenerator() {
    // Hide test generator
    document.getElementById('testGenerator').style.display = 'none';
    
    // Show dashboard again
    document.getElementById('userDashboard').style.display = 'block';
    showUserDashboard();
}

function showTestGeneratorButton() {
    // This creates a nav link for logged-in users only
    const navLinks = document.querySelector('.nav-links');
    
    // Check if button already exists
    if (!document.getElementById('testGenNavBtn')) {
        const testGenLink = document.createElement('a');
        testGenLink.id = 'testGenNavBtn';
        testGenLink.href = '#';
        testGenLink.textContent = 'Test Generator';
        testGenLink.onclick = function(e) {
            e.preventDefault();
            showTestGenerator();
        };
        
        // Insert before the sign-in button (which is now hidden)
        navLinks.insertBefore(testGenLink, navLinks.querySelector('.btn-primary'));
    }
}
            
            // Check question limits
if (!currentUser.subscribed && questionCount >= 3) {
    showAlert('You\'ve used all 3 free trial questions! Please choose a plan to continue.', 'error');
    startSubscription();
    return;
}

if (currentUser.subscribed && currentUser.plan_type === 'basic' && currentUser.questions_this_month >= 100) {
    showAlert('You\'ve reached your 100 question monthly limit. Upgrade to Unlimited!', 'error');
    startSubscription();
    return;
}
    
    if (currentUser.subscribed && currentUser.plan_type === 'basic' && 
        currentUser.questions_this_month >= 100) {
        showAlert('You\'ve reached your 100 question monthly limit. Upgrade to Unlimited for more!', 'error');
        showSubscriptionModal();
        return;
    }

            const responseSection = document.getElementById('responseSection');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const responseContent = document.getElementById('responseContent');
            const submitBtn = document.getElementById('submitBtn');

            responseSection.classList.add('show');
            loadingIndicator.style.display = 'block';
            responseContent.style.display = 'none';
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            try {
                const response = await callSecureAPI(question, imageFile);
                responseContent.innerHTML = formatResponse(response);
                
                 await fetch('/api/users.js', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            action: 'incrementQuestions',
            email: currentUser.email
        })
    });
                
                questionCount++;
                localStorage.setItem('question_count', questionCount.toString());
                updateQuestionCount();

            } catch (error) {
                console.error('Error:', error);
                responseContent.innerHTML = '<div class="alert alert-error">Sorry, there was an error processing your question. Please try again.</div>';
            } finally {
                loadingIndicator.style.display = 'none';
                responseContent.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Get solution';
            }
        }

// Call our secure backend API
async function callSecureAPI(question, imageFile) {
    const requestBody = {
        question: question
    };

    // Add image if provided
    if (imageFile) {
        const base64Image = await fileToBase64(imageFile);
        requestBody.imageData = base64Image.split(',')[1];
        requestBody.imageType = imageFile.type;
    }

    const response = await fetch('/api/question.js', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(requestBody)
    });

    if (!response.ok) {
        throw new Error(`API error: ${response.status}`);
    }

    const data = await response.json();
    return data.response;
}

        // Convert file to base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // Format response for display
        function formatResponse(text) {
            let formatted = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            return `<p>${formatted}</p>`;
        }

        // Check if user is in trial period
     
        // Start subscription process
     async function startSubscription() {
    // If no user logged in, close subscription modal and show signup
    if (!currentUser) {
        hideSubscriptionModal(); // Close the subscription modal first
        localStorage.setItem('pending_subscription', 'true'); // Remember they want to subscribe
        showModal('signup'); // Show signup modal
        return;
    }
    
    // If user is logged in, redirect to pricing section to choose a plan
    hideSubscriptionModal();
    document.getElementById('pricing').scrollIntoView({ behavior: 'smooth' });
    showAlert('Please select a plan below', 'success');
}


        // Show alert messages
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            const appSection = document.getElementById('app');
            appSection.insertBefore(alertDiv, appSection.firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // Modal functions
        function showModal(type) {
    const modal = document.getElementById('authModal');
    const loginForm = document.getElementById('loginForm');
    const signupForm = document.getElementById('signupForm');
    
    if (type === 'login') {
        loginForm.style.display = 'block';
        signupForm.style.display = 'none';
    } else {
        loginForm.style.display = 'none';
        signupForm.style.display = 'block';
        
        // Find the subtitle paragraph in the signup form
        const subtitle = signupForm.querySelector('p[style*="color: var(--text-secondary)"]');
        
        // Check if user is coming from subscription intent
        if (localStorage.getItem('pending_subscription') === 'true') {
            // Change subtitle to indicate direct subscription
            if (subtitle) {
                subtitle.innerHTML = 'Create your account to complete subscription';
            }
            // Also update the button text
            const submitButton = signupForm.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.textContent = 'Create account & subscribe';
            }
        } else {
            // Reset to normal trial text if not from subscription
            if (subtitle) {
                subtitle.innerHTML = 'Sign up to get 3 free questions';
            }
            const submitButton = signupForm.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.textContent = 'Create account & start trial';
            }
        }
    }
    
    modal.classList.add('show');
}

        function hideModal() {
            document.getElementById('authModal').classList.remove('show');
        }

        // Subscription modal functions
        function showSubscriptionModal() {
            document.getElementById('subscriptionModal').classList.add('show');
        }

        function hideSubscriptionModal() {
            document.getElementById('subscriptionModal').classList.remove('show');
        }

                // Account Settings Functions
        function showAccountSettings() {
            document.getElementById('accountSettingsModal').classList.add('show');
            // Update profile info when opening
            if (currentUser) {
                document.getElementById('profileName').value = currentUser.name;
                document.getElementById('profileEmail').value = currentUser.email;
                document.getElementById('settingsQuestionsUsed').textContent = questionCount;
                document.getElementById('settingsTotalQuestions').textContent = questionCount;
            }
        }
        
        function hideAccountSettings() {
            document.getElementById('accountSettingsModal').classList.remove('show');
        }
        
        function showSettingsTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.settings-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.settings-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').style.display = 'block';
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
        
        function updatePaymentMethod() {
            alert('Redirecting to payment method update...');
            // This would integrate with Stripe customer portal
        }

         function updateTrialDays() {
    const element = document.getElementById('daysLeft');
    const daysCard = element?.closest('.stat-card');
    
    if (currentUser && currentUser.subscribed) {
        // Hide trial days for subscribed users
        if (daysCard) daysCard.style.display = 'none';
    } else if (currentUser && currentUser.trial_end) {  // Changed here
        // Show trial days for trial users
        if (daysCard) daysCard.style.display = 'block';
        const now = new Date();
        const trialEndDate = new Date(currentUser.trial_end);
                const daysLeft = Math.max(0, Math.ceil((trialEndDate - now) / (24 * 60 * 60 * 1000)));
                if (element) {
                    element.textContent = daysLeft;
                }
            }
        }
        
        function contactSupport() {
            window.location.href = 'mailto:support@homeworkhippo.com?subject=HomeworkHippo Support Request';
        }
        
        function showCancelFlow() {
            hideAccountSettings();
            showCancelStep1();
        }

        // Cancel Flow Step 1 - Are you sure?
        function showCancelStep1() {
            document.getElementById('cancelStep1Modal').classList.add('show');
        }
        
        function hideCancelStep1() {
            document.getElementById('cancelStep1Modal').classList.remove('show');
        }
        
        // Cancel Flow Step 2 - Alternatives
        function showCancelStep2() {
            hideCancelStep1();
            document.getElementById('cancelStep2Modal').classList.add('show');
        }
        
        function hideCancelStep2() {
            document.getElementById('cancelStep2Modal').classList.remove('show');
        }
        
        // Cancel Flow Step 3 - Final confirmation
        function showCancelStep3() {
            hideCancelStep2();
            document.getElementById('cancelStep3Modal').classList.add('show');
        }
        
        function hideCancelStep3() {
            document.getElementById('cancelStep3Modal').classList.remove('show');
        }
        
        // Actually cancel subscription
       function confirmCancellation() {
    cancelSubscriptionWithStripe(); // This will actually cancel it
}
        
        // Retention options
        function pauseSubscription() {
            alert('Subscription paused for 30 days. You can reactivate anytime!');
            hideCancelStep2();
        }
        
        function contactSupport() {
            window.location.href = 'mailto:support@homeworkhippo.com?subject=Need Help with HomeworkHippo';
            hideCancelStep2();
        }

        function switchToSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
        }

        function switchToLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
        }

                // Auth handling
        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch('/api/users.js', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'login',
                        email,
                        password
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.user;
                    localStorage.setItem('homeworkhippo_user', JSON.stringify(currentUser));
                    hideModal();
                    showUserDashboard();
                    showAlert('Welcome back! You can now ask questions.', 'success');
                } else {
                    showAlert('Invalid email or password.', 'error');
                }
            } catch (error) {
                console.error('Login error:', error);
                showAlert('Login failed. Please try again.', 'error');
            }
        }

        async function handleSignup(event) {
    event.preventDefault();
    const email = document.getElementById('signupEmail').value;
    const phone = document.getElementById('signupPhone').value.replace(/\D/g, '');
    const password = document.getElementById('signupPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    // Validation
    if (password !== confirmPassword) {
        showAlert('Passwords do not match.', 'error');
        return;
    }
    
    if (password.length < 6 || !/[A-Z]/.test(password) || !/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
        showAlert('Password must be at least 6 characters with 1 uppercase and 1 special character.', 'error');
        return;
    }
    
    if (phone.length !== 10) {
        showAlert('Please enter a valid 10-digit phone number.', 'error');
        return;
    }
    
    try {
        const response = await fetch('/api/users.js', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                action: 'signup',
                name: email.split('@')[0],
                email,
                phone,
                password
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            currentUser = data.user;
            localStorage.setItem('homeworkhippo_user', JSON.stringify(currentUser));
            hideModal();
            showUserDashboard();
            
            showAlert('Welcome! Check your email to verify your account. Your 7-day trial has started!', 'success');
            
            // Check if they selected a plan before signing up
            const selectedPlan = localStorage.getItem('selected_plan');
            if (selectedPlan) {
                const billingPeriod = localStorage.getItem('billing_period') || 'monthly';
                localStorage.removeItem('selected_plan');
                localStorage.removeItem('billing_period');
                setTimeout(() => {
                    startCheckout(selectedPlan, billingPeriod);
                }, 2000);
            }
        } else {
            showAlert(data.error || 'Signup failed. Please try again.', 'error');
        }
    } catch (error) {
        console.error('Signup error:', error);
        showAlert('Signup failed. Please try again.', 'error');
    }
}


        
        async function cancelSubscriptionWithStripe() {
    try {
        const response = await fetch('/api/cancel-subscription.js', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                email: currentUser.email
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Update local user data
            currentUser.subscribed = false;
            localStorage.setItem('homeworkhippo_user', JSON.stringify(currentUser));
            
            alert('Your subscription has been cancelled successfully.');
            hideCancelStep3();
            location.reload();
        } else {
            alert('No active subscription found or already cancelled.');
        }
    } catch (error) {
        console.error('Cancellation error:', error);
        alert('Error cancelling subscription. Please contact support.');
    }
}
        
      function showUserDashboard() {
    document.getElementById('userDashboard').classList.add('show');
    document.getElementById('userName').textContent = currentUser.name;
    updateQuestionCount();
    updateTrialDays();
    
    // Hide marketing sections for logged-in users
    document.querySelector('.hero').style.display = 'none';
    document.getElementById('features').style.display = 'none';
    document.getElementById('pricing').style.display = 'none';
    // Hide sign-in button in navigation
    document.querySelector('.nav-links .btn-primary').style.display = 'none';
    
    // Hide Features and Pricing navigation links
    document.querySelectorAll('.nav-links a[href="#features"], .nav-links a[href="#pricing"]').forEach(link => {
        link.style.display = 'none';
    });
          
    // Show test generator button for logged-in users
    showTestGeneratorButton();
    }

   function updateQuestionCount() {
    const askedElement = document.getElementById('questionsAsked');
    const remainingElement = document.getElementById('questionsRemaining');
    
    if (askedElement && currentUser) {
        askedElement.textContent = currentUser.questions_this_month || 0;
    }
    
    if (remainingElement && currentUser) {
        if (currentUser.plan_type === 'unlimited') {
            remainingElement.textContent = '∞';
            remainingElement.nextElementSibling.textContent = 'Unlimited questions';
        } else if (currentUser.plan_type === 'basic') {
            const remaining = Math.max(0, 100 - (currentUser.questions_this_month || 0));
            remainingElement.textContent = remaining;
            remainingElement.nextElementSibling.textContent = 'Questions remaining this month';
        } else {
            // Trial users
            const remaining = Math.max(0, 3 - questionCount);
            remainingElement.textContent = remaining;
            remainingElement.nextElementSibling.textContent = 'Trial questions remaining';
        }
    }
}

  

       function logout() {
    currentUser = null;
    localStorage.removeItem('homeworkhippo_user');
    document.getElementById('userDashboard').classList.remove('show');
    document.getElementById('responseSection').classList.remove('show');
    document.getElementById('questionInput').value = '';
    
     // Hide test generator
    document.getElementById('testGenerator').style.display = 'none';
    
    // Remove test generator nav button
    const testGenBtn = document.getElementById('testGenNavBtn');
    if (testGenBtn) testGenBtn.remove();
           
    // Show marketing sections again for logged-out users
    document.querySelector('.hero').style.display = 'block';
    document.getElementById('features').style.display = 'block';
    document.getElementById('pricing').style.display = 'block';

    // Show sign-in button and navigation links again
    document.querySelector('.nav-links .btn-primary').style.display = 'inline-block';
    document.querySelectorAll('.nav-links a[href="#features"], .nav-links a[href="#pricing"]').forEach(link => {
        link.style.display = 'inline-block';
    });
    
    showAlert('You have been signed out.', 'success');
}


        // Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (!href || href === '#') return; // ← Add this line to skip empty anchors
        
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

        // Close modal when clicking outside
        document.getElementById('authModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideModal();
            }
        });

        // Handle keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideModal();
            }
        });
    </script>
</body>

</html>








































































































